domain: swe-lite
topic: python
train_or_test: TEST
repo: ''
task_name: django__django-14580
revision: 36fa071d6ebd18a61c4d7f1b5c9d17106134bd44
dockerfile: ./Dockerfile
integrations_yaml: ../../extra/_integrations.yaml
variables_yaml: ./_variables.yaml
verification:
    run_python: ../../extra/verification.py
    run_python_params:
    - django__django-14580
    - princeton-nlp/SWE-bench_Lite
    - test
task:
-   role: user
    content: "\n            You are solving a Github issue in the repository .\n            You must make the changes to solve,\
        \ close, or address the issue, directly in the code.\n            Missing import statement in generated migration\
        \ (NameError: name 'models' is not defined)\nDescription\n\t\nI found a bug in Django's latest release: 3.2.4. \n\
        Given the following contents of models.py:\nfrom django.db import models\nclass MyField(models.TextField):\n\tpass\n\
        class MyBaseModel(models.Model):\n\tclass Meta:\n\t\tabstract = True\nclass MyMixin:\n\tpass\nclass MyModel(MyMixin,\
        \ MyBaseModel):\n\tname = MyField(primary_key=True)\nThe makemigrations command will generate the following migration\
        \ file:\n# Generated by Django 3.2.4 on 2021-06-30 19:13\nimport app.models\nfrom django.db import migrations\nclass\
        \ Migration(migrations.Migration):\n\tinitial = True\n\tdependencies = [\n\t]\n\toperations = [\n\t\tmigrations.CreateModel(\n\
        \t\t\tname='MyModel',\n\t\t\tfields=[\n\t\t\t\t('name', app.models.MyField(primary_key=True, serialize=False)),\n\t\
        \t\t],\n\t\t\toptions={\n\t\t\t\t'abstract': False,\n\t\t\t},\n\t\t\tbases=(app.models.MyMixin, models.Model),\n\t\
        \t),\n\t]\nWhich will then fail with the following error:\n File \"/home/jj/django_example/app/migrations/0001_initial.py\"\
        , line 7, in <module>\n\tclass Migration(migrations.Migration):\n File \"/home/jj/django_example/app/migrations/0001_initial.py\"\
        , line 23, in Migration\n\tbases=(app.models.MyMixin, models.Model),\nNameError: name 'models' is not defined\nExpected\
        \ behavior: Django generates a migration file that is valid Python.\nActual behavior: Django generates a migration\
        \ file that is missing an import statement.\nI think this is a bug of the module django.db.migrations.writer, but\
        \ I'm not sure. I will be happy to assist with debugging.\nThanks for your attention,\nJaap Joris\n"
